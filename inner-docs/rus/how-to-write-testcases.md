# Рекомендации по написанию тест кейсов, чтобы их можно было автоматизировать

TODO: поревьюить этот документ с точки зрения log driven testing. Лаконизировать текст.
Если перед текстом стоит `?`, это значит не решено надо ли это делать и как это делать. 

* Название теста должно давать информацию по тесту.
Посмотрел название и примерно понял про что тест.
Длинные названия - нормально.

* Название теста должно быть уникальным.

* Тест план должен быть структурирован.

* Если этого ещё не сделано для кейсов можно сделать следующие поля:
  * `теги`
  * `пресет БД`
  * `автотест` - хранит путь к сорцу автотеста
  * ? `пререквизиты` - ручные действия
  * `приоритет`
  * `тип теста` (негативный, позитивный, и т.д. любая классификация хороша)

* Пишем кейсы для выполнения тестировщиком, который не в курсе что у нас за приложение, но он знает
все наши термины, названия контролов, умеет пользоваться этими контролами, мышкой и клавиатурой.
Продумываем какие у этого человека могут возникнуть вопросы по кейсу, в идеальном кейсе
вопросов возникать не должно.

* Т.е. Тесткейс нужно детализировать до уровня работы с контролами.

* Использовать общепринятые названия для элементов управления (контролов), см документ с терминами.

* Лог от автотеста должен быть похож на тест кейс. Шаги, проверки.

* В путях использовать `/` как разделитель.

* Но, допустимо включать в тестплан и неформализованные мысли, которые что-то поясняют.

* Чтобы отделять названия элементов управления от прочего текста тестплана - названия заключаем в кавычки.
Ожидаемые тексты - тоже в кавычках.

* Лучше проверять присутствие чего-то, чем отсутствие чего-то.
Проверка на то, что в контроле есть определенные 8 строк (в определенном порядке)
- это 8 сравнений строк.
Проверка, что нет каких-то 10 строк в списке из 8 строк - это 80 сравнений строк.

* Какие параметры контролов упоминать в кейсе.
  * Если один из смыслов кейса проверить содержание контрола, то следует указывать всё (брать можно из лога
  пробного запуска TIA теста):
    * Метка (label)
    * Тултип (tooltip)
    * Плейсхолдер
    * enabled/disabled
    * Набор значений внутри контрола

  * Если речь идёт о взаимодействии с контролом, и нет цели описать содержимое контрола, то
    * Строка, идентифицирующая контрол для тестировщика (label, tooltip).
    * Какое значение ввести или выбрать (если нужно).

* Описывать как меняется URL в браузере при переходе по разным страницам и элементам.
`Проверить, что URL #такой-то`.

* По-возможности избегать скриншотов, т.к.:
  * не скопипастить текст из них в код теста.
  * на скриншотах не видны тултипы и внутренние значения.

* Пререквизиты теста могут быть получены:
  * Установкой пресета БД и перезапуском приложения (занимает 3 минуты).
  * ?Установка пресета БД без перезапуска, но с перелогином (занимает 1.5 минуты).
  * ?Установка пресета БД без перезапуска и без перелогина (занимает 1 минуту).
  * Предварительное выполнение кейса - пререквизита (секунды).
  * Запуск функции для работы с БД (секунды).
  * Просто приведение какого-то интерфейса в начальное состояние (секунды).

* Важно взвешивать когда какой способ получения пререквизита лучше задействовать.

* По-возможности следует группировать тесты в директории и сьюты, которые работают от одного пресета.

* Общие процедуры.
Если test rails поддерживает понятие общих процедур. То можно выносить туда наборы действий и/или проверок,
которые встречаются во многих кейсах. И из кейсов ссылаться на эти общие процедуры.
Придумывать процедурам информативные названия.
Если в test rails нет понятия общих процедур, то можно оформлять их в виде тест кейсов.
И хранить их в какой-нибудь папке `common`. Можно делать `common` на любом уровне вложенности.

* Думать, какие функции для работы с БД могли бы пригодиться (типа: `удалить все инциденты`, 
заполнить какую-то таблицу фейковыми данными). Описывать их в общих процедурах.
В TIA мы поддержим эти функции.

* Нумеровать ли пункты тест кейсов. Я бы не нумеровал, по-возможности. Если нужна какая-то логическая метка на
какой-то пункт, я бы сделал её английскими буквами, а не цифрой. Кейсы будут часто меняться. И запаришься
перенумеровывать всё. А метка будет оставаться неизменной.

* Если непонятно как обозвать в кейсе какой-то контрол - можно спросить у автоматизатора, или у девелоперов.

## Картинки, цвета, местоположение элементов Web страницы

По возможности, нужно избегать привязки к рисункам, цветам, местоположению элементов
(слева / справа / сверху / снизу).

Функции распечатки элементов в лог должны иметь возможность печатать название файлов с рисунками.
Вот к этому названию можно привязаться, или посмотреть что ещё есть при выводе в тестовый лог этого элемента.

Название файлов для иконок можно попытаться взять из development tools вашего браузера.

TODO: научить Ej Explorer выдавать эти названия.

## Фейковые данные

На примере интеграций. Эти тесты имеет смысл разбивать на два вида.

1. Запуск реальных интеграций и минимальные проверки, что всё подтянулось что надо,
и выборочно что поля появились.
Цель тестов, - проверить, что от внешней системы сущности отдаются более менее правильно.

2. Запуск интеграций с фейковыми данными. И там уже продумывать какие фейковые данные нужны
и заводить задачки для девелоперов для создания таких данных, с учётом версий внешних систем.
Цель теста - досконально проверить все отмапленные поля, связи, и т.д..

Никто не гарантирует, что во внешних системах всегда будут одни и те же данные.
Поэтому завязываться на них в тестах = нестабильность тестов и куча поддержки.
А если в пререквизиты записать, что мы должны создать во внешней системе что-то,
то это скорее только руками, и это не автотестирование.


## На что можно обращать внимание для разных контролов:

Возможно, часть из этих пунктов - функциональность ExtJs, которую сильно тестить не надо.

* Везде ли в гридах разрешены одинаковые элементы.
* В гридах посмотреть работу сортировок.
* Проверить наличие всех хелпов.
* Проверка везде enabled / disabled элементов.
* Везде проверять плейсхолдеры.
* Проверять работу всяких чекбоксов, которые включают/выключают какой-то функционал.
* Проверять наличие всех вариантов в разных контролах (например, в комбобоксах).
* Наличие всех тултипов.
* Срабатывание кнопок, очищающих элемнты.
* Отмена ввода.
* Полосы прокруток.
* Развернуть / свернуть окно.
* Закрытие диалогие.
* Взаимозависимые контролы. Где-то добавляешь то, что потом будет появляться/удаляться в других контролах.
* Сохраняются ли значения полей при смене страниц туда - сюда.
* Допустимые значения для разных контролов (типы, диапазоны).
* Значения по умолчанию.
* Предзаполненные элементы гридов.
* Начальное состояние базы.
